<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#58CC02">
  <title>LinguaKids - Level 3 (Chinese)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    body, html { 
      margin: 0; 
      padding: 0; 
      font-family: 'Quicksand', sans-serif; 
      background:#f6f8ff; 
      overflow-x: hidden;
    }

    h2 { 
      text-align:center; 
      color:#58cc02; 
      font-family:'Baloo 2', cursive; 
    }

    .item-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin: 20px auto;
      padding: 0 15px;
      max-width: 1000px;
      box-sizing: border-box;
    }

    .item-card {
      background: white;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      width: 100%;
      box-sizing: border-box;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .item-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0,0,0,0.15);
    }

    .question {
      font-weight: bold;
      color: #1cb0f6;
      margin-bottom: 6px;
      font-size: 1.3rem;
    }
    .hanzi { font-size: 1.3rem; margin-bottom: 4px; }
    .pinyin { color: #1cb0f6; margin-bottom: 4px; }
    .english { color: #555; margin-bottom: 6px; }

    .speak-btn {
      background: linear-gradient(to right,#58cc02,#1cb0f6);
      border: none; 
      color: white; 
      padding: 6px 12px;
      border-radius: 50px; 
      cursor: pointer;
      font-size: 0.9rem; 
      font-family: 'Baloo 2', cursive;
      margin: 3px;
      transition: all 0.3s;
    }
    .speak-btn:hover { 
      opacity: 0.9; 
      transform: scale(1.05);
    }

    .btn {
      background: linear-gradient(to right,#58cc02,#1cb0f6);
      border: none; 
      color: white; 
      padding: 8px 20px; 
      border-radius: 50px;
      font-family: 'Baloo 2', cursive; 
      cursor: pointer; 
      margin: 10px 5px;
      transition: all 0.3s;
    }
    .btn:active { transform: scale(0.96); }
    .btn:hover { opacity: 0.9; }

    @media (max-width: 900px) { .item-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 600px) { .item-grid { grid-template-columns: repeat(1, 1fr); } }

    /* Toast notification styles */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #58cc02;
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 10px;
      transform: translateY(100px);
      opacity: 0;
      transition: transform 0.3s, opacity 0.3s;
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Category navigation */
    .category-nav {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .category-btn {
      background: #e0e0e0;
      border: none;
      padding: 8px 15px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .category-btn.active {
      background: #58cc02;
      color: white;
    }

    .category-btn:hover {
      background: #d0d0d0;
    }

    .category-btn.active:hover {
      background: #4bb802;
    }

    /* Back button positioning */
    .back-button-container {
      position: fixed;
      top: 15px;
      left: 15px;
      z-index: 1000;
    }

    .back-button-container .btn {
      margin: 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    /* Main content area */
    #content {
      padding-top: 60px;
      position: relative;
      z-index: 1;
    }

    @media (max-width: 600px) {
      .back-button-container {
        top: 10px;
        left: 10px;
      }
      
      .back-button-container .btn {
        padding: 8px 16px;
        font-size: 0.9rem;
      }
      
      #content {
        padding-top: 50px;
      }
    }
  </style>
</head>
<body>
  <div class="back-button-container">
    <button onclick="goBack()" class="btn">Back</button>
  </div>
  
  <div id="content">
    <h2 id="categoryTitle"></h2>
    
    <!-- Category Navigation -->
    <div class="category-nav">
      <button class="category-btn" onclick="changeCategory('greetings')">Greetings</button>
      <button class="category-btn" onclick="changeCategory('activities')">Activities</button>
    </div>
    
    <div class="item-grid" id="itemGrid"></div>
  </div>

  <!-- Toast Notification -->
  <div id="achievementToast" class="toast">
    <i class="fas fa-trophy"></i>
    <div>
      <div id="toastTitle">ÊàêÂ∞±Ëß£ÈîÅ! Achievement Unlocked!</div>
      <div id="toastDesc">You've earned a new badge.</div>
    </div>
  </div>

<script>
const DATA = {
  greetings: [
    { char: "‰Ω†Â•ΩÔºÅ", pinyin: "n«ê h«éo!", english: "Hello! üëã" },
    { char: "Êó©‰∏äÂ•ΩÔºÅ", pinyin: "z«éoshang h«éo!", english: "Good morning! ‚òÄÔ∏è" },
    { char: "‰∏ãÂçàÂ•ΩÔºÅ", pinyin: "xi√†w«î h«éo!", english: "Good afternoon! üåû" },
    { char: "Êôö‰∏äÂ•ΩÔºÅ", pinyin: "w«énsh√†ng h«éo!", english: "Good evening! üåô" },
    { char: "ÊôöÂÆâÔºÅ", pinyin: "w«én'ƒÅn!", english: "Good night! üåú" },
    { char: "‰Ω†Â•ΩÂêóÔºü", pinyin: "n«ê h«éo ma?", english: "How are you?" },
    { char: "‰Ω†Âè´‰ªÄ‰πàÂêçÂ≠óÔºü", pinyin: "n«ê ji√†o sh√©nme m√≠ngzi?", english: "What's your name?" },
    { char: "ÂæàÈ´òÂÖ¥ËÆ§ËØÜ‰Ω†ÔºÅ", pinyin: "hƒõn gƒÅox√¨ng r√®nshi n«ê!", english: "Nice to meet you!" },
    { char: "ÂÜçËßÅÔºÅ", pinyin: "z√†iji√†n!", english: "See you later üëã" },
    { char: "Ë∞¢Ë∞¢ÔºÅ", pinyin: "xi√®xi√®!", english: "Thank you üòä" },
    { char: "Ê¨¢ËøéÔºÅ", pinyin: "huƒÅny√≠ng!", english: "Welcome! ü§ó" },
{ char: "‰Ω†Â•ΩÂêóÔºü", pinyin: "n«ê h«éo ma?", english: "Are you okay? üôÇ" },
{ char: "ÊàëÂæàÂ•ΩÔºÅ", pinyin: "w«í hƒõn h«éo!", english: "I am good! üòÑ" },
{ char: "Â§™Ë∞¢Ë∞¢‰Ω†‰∫ÜÔºÅ", pinyin: "t√†i xi√®xie n«ê le!", english: "Thank you so much! üôè" },
{ char: "‰∏çÂÆ¢Ê∞îÔºÅ", pinyin: "b√∫ k√®qi!", english: "You're welcome! üòä" },
{ char: "ÂØπ‰∏çËµ∑ÔºÅ", pinyin: "du√¨buq«ê!", english: "Sorry! üòû" },
{ char: "Ê≤°ÂÖ≥Á≥ªÔºÅ", pinyin: "m√©i guƒÅnxi!", english: "It's okay! üòä" },
{ char: "Á•ù‰Ω†Âø´‰πêÔºÅ", pinyin: "zh√π n«ê ku√†il√®!", english: "Wish you happiness! üéâ" },
{ char: "ËØ∑Á≠â‰∏Ä‰∏ãÔºÅ", pinyin: "q«êng dƒõng y√≠xi√†!", english: "Please wait a moment! ‚è≥" },
{ char: "Âä†Ê≤πÔºÅ", pinyin: "jiƒÅy√≥u!", english: "You can do it! üí™" }

  ],
  activities: [
    { char: "ÊàëÂêÉËãπÊûú üçé", pinyin: "w«í chƒ´ p√≠nggu«í", english: "I eat an apple üçé" },
    { char: "ÊàëÂéªÂ≠¶Ê†° üè´", pinyin: "w«í q√π xu√©xi√†o", english: "I go to school üè´" },
    { char: "ÊàëÂíåÊúãÂèãÁé© üë´", pinyin: "w«í h√© p√©ngy«íu w√°n", english: "I play with friends üë´" },
    { char: "ÊàëÁúã‰π¶ üìö", pinyin: "w«í k√†n sh≈´", english: "I read books üìö" },
    { char: "ÊàëÁúãÁîµËßÜ üì∫", pinyin: "w«í k√†n di√†nsh√¨", english: "I watch TV üì∫" },
    { char: "ÊàëÂ∏ÆÂ¶àÂ¶à üë©", pinyin: "w«í bƒÅng mƒÅmƒÅ", english: "I help my mom üë©" },
    { char: "ÊàëÊ¥óÊæ° üõÅ", pinyin: "w«í x«êz«éo", english: "I take a bath üõÅ" },
    { char: "ÊàëÂà∑Áâô ü¶∑", pinyin: "w«í shuƒÅ y√°", english: "I brush my teeth ü¶∑" },
    { char: "ÊàëÊôö‰∏äÁù°Ëßâ üò¥", pinyin: "w«í w«énsh√†ng shu√¨ji√†o", english: "I sleep at night üò¥" },
    { char: "ÊàëÂñùÊ∞¥ üíß", pinyin: "w«í hƒì shu«ê", english: "I drink water üíß" },
    { char: "ÊàëÁîªÁîª üé®", pinyin: "w«í hu√†hu√†", english: "I draw üé®" },
{ char: "ÊàëÂî±Ê≠å üé§", pinyin: "w«í ch√†nggƒì", english: "I sing üé§" },
{ char: "ÊàëË∑≥Ëàû üíÉ", pinyin: "w«í ti√†ow«î", english: "I dance üíÉ" },
{ char: "ÊàëÂÜô‰Ωú‰∏ö ‚úèÔ∏è", pinyin: "w«í xiƒõ zu√≤y√®", english: "I do homework ‚úèÔ∏è" },
{ char: "ÊàëË∑ëÊ≠• üèÉ‚Äç‚ôÄÔ∏è", pinyin: "w«í p«éob√π", english: "I run üèÉ‚Äç‚ôÄÔ∏è" },
{ char: "ÊàëÁé©Ê∏∏Êàè üéÆ", pinyin: "w«í w√°n y√≥ux√¨", english: "I play games üéÆ" },
{ char: "ÊàëÂê¨Èü≥‰πê üéß", pinyin: "w«í tƒ´ng yƒ´nyu√®", english: "I listen to music üéß" },
{ char: "ÊàëÂÅöÈ•≠ üç≥", pinyin: "w«í zu√≤f√†n", english: "I cook üç≥" },
{ char: "ÊàëÊâìÊâ´ÊàøÈó¥ üßπ", pinyin: "w«í d«és«éo f√°ngjiƒÅn", english: "I clean my room üßπ" },
{ char: "Êàë‰π∞‰∏úË•ø üõí", pinyin: "w«í m«éi d≈çngxi", english: "I buy things üõí" }
  ]
};

let currentCategory = 'greetings';

function getCategory(){
  const params = new URLSearchParams(window.location.search);
  return params.get("category") || 'greetings';
}

function loadCategory(category = null){
  if (category) {
    currentCategory = category;
    // Update URL without page reload
    const newUrl = `${window.location.pathname}?category=${category}`;
    window.history.replaceState({}, '', newUrl);
  } else {
    currentCategory = getCategory();
  }
  
  const items = DATA[currentCategory] || [];

  document.getElementById("categoryTitle").textContent = getCategoryTitle(currentCategory);

  // Update active category button
  document.querySelectorAll('.category-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.textContent.toLowerCase() === currentCategory) {
      btn.classList.add('active');
    }
  });

  document.getElementById("itemGrid").innerHTML = items.map(i => `
    <div class="item-card">
      <div class="question">${i.char}</div>
      <div class="pinyin">${i.pinyin}</div>
      <div class="english">${i.english}</div>
      <div class="lesson-controls">
        <button class="speak-btn" onclick="speakSentence('${i.char}', '${currentCategory}')">üîä Sentence</button>
        <button class="speak-btn" onclick="speak('${i.pinyin}')">üîä Pinyin</button>
      </div>
    </div>
  `).join("");
}

function changeCategory(category) {
  loadCategory(category);
}

function getCategoryTitle(category) {
  const categoryTitles = {
    greetings: "Greetings & Expressions",
    activities: "Daily Activities"
  };
  return categoryTitles[category] || "Category";
}

function speak(text){
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = "zh-CN";
  speechSynthesis.speak(utter);
}

function speakSentence(sentence, category) {
  const utter = new SpeechSynthesisUtterance(sentence);
  utter.lang = "zh-CN";
  speechSynthesis.speak(utter);
  
  trackSentenceInteraction(category);
}

function trackSentenceInteraction(category) {
  const interactionKey = `sentence_interaction_${category}_${new Date().toDateString()}`;
  let interactions = parseInt(sessionStorage.getItem(interactionKey) || '0');
  
  interactions++;
  sessionStorage.setItem(interactionKey, interactions.toString());
  
  // Award progress for every 2 interactions
  if (interactions % 2 === 0 && typeof updateProgress === 'function') {
    updateProgress('level3', category, 1);
  }
}

function goBack(){
  window.location.href = "chinese.html";
}

// Ensure the page loads content on DOM ready
document.addEventListener('DOMContentLoaded', function() {
  loadCategory();
});
</script>
<script src="script.js"></script>
<script src="chprogress.js"></script>

</body>
</html>
<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#58CC02">
  <title>LinguaKids - Marathi</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Quicksand', Arial, sans-serif;
        background: linear-gradient(135deg, #e0eaff 0%, #f6f0ff 100%);
        margin: 0;
        padding: 0;
    }
    
    #app { 
        max-width: 1000px; 
        margin: auto; 
        padding: 15px; 
        position: relative;
        padding-top: 50px;
    }
    
    h2 { 
        text-align: center; 
        color: #58cc02; 
        font-family: 'Baloo 2', cursive; 
    }
    
    .sub-container, .letters-grid, .numbers-grid {
        display: grid; 
        grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
        gap: 15px; 
        margin-top: 20px;
    }
    
    .sub-card, .letter-card, .number-card {
        background: white; 
        padding: 20px; 
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); 
        text-align: center;
        cursor: pointer; 
        transition: transform 0.3s, box-shadow 0.3s;
        word-wrap: break-word;
        overflow-wrap: break-word;
        white-space: normal;
    }
    
    .letter-card, .number-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 140px;
        justify-content: space-between;
    }
    
    .sub-card:hover, .letter-card:hover, .number-card:hover {
        transform: translateY(-5px); 
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }
    
    .main-char { 
        font-size: 2rem; 
        font-weight: bold; 
        color: #58cc02; 
    }
    
    .small-char { 
        font-size: 1.2rem; 
        color: #1cb0f6; 
    }
    
    .example { 
        margin-top: 5px; 
        font-size: 1rem; 
        line-height: 1.2;
    }
    
    .letter-card .example, .number-card .example {
        font-size: 0.9rem;
        max-height: 2.4em;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        line-clamp: 2;
    }
    
    .btn {
        background: linear-gradient(to right, #58cc02, #1cb0f6);
        border: none; 
        color: white; 
        padding: 8px 20px; 
        border-radius: 50px;
        font-family: 'Baloo 2', cursive; 
        cursor: pointer; 
        margin: 10px 5px;
        transition: transform 0.2s;
    }
    
    .btn:active { 
        transform: scale(0.96); 
    }
    
    .lesson-controls {
        display: flex; 
        justify-content: center; 
        gap: 10px; 
        margin-top: 15px;
        flex-wrap: wrap;
    }
    
    canvas {
        border: 2px solid #ccc; 
        border-radius: 12px; 
        background: #fff;
        display: block; 
        margin: 15px auto;
    }
    
    .lesson-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        margin-top: 20px;
    }
    
    .lesson-container .main-char {
        font-size: 3rem;
    }
    
    .lesson-container .example {
        font-size: 1.3rem;
        margin: 10px 0;
    }
    
    .trace-area {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 10px 0;
    }
    
    .clear-btn {
        background: #ff6b6b;
        padding: 5px 15px;
        font-size: 0.9rem;
        border-radius: 8px;
        margin-top: 8px;
        transition: background 0.3s;
    }
    
    .clear-btn:hover {
        background: #ff5252;
    }
    
    .sub-card h3 {
        font-size: 1.1rem;
        margin: 5px 0;
    }
    
    .sub-card p {
        font-size: 0.9rem;
        margin: 0;
        line-height: 1.2;
    }
    
    .sound-btn {
        background: #1cb0f6;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        color: white;
        font-size: 1rem;
        cursor: pointer;
        margin-top: 8px;
        transition: all 0.2s;
    }
    
    .sound-btn:hover {
        background: #0a9bd8;
        transform: scale(1.05);
    }
    
    .sound-btn:active {
        transform: scale(0.95);
    }
    
    .tab-container {
        display: flex;
        justify-content: center;
        margin: 20px 0;
        flex-wrap: wrap;
    }
    
    .tab-btn {
        background: #e0e0e0;
        border: none;
        padding: 10px 20px;
        margin: 0 5px;
        border-radius: 20px;
        cursor: pointer;
        font-family: 'Baloo 2', cursive;
        transition: all 0.3s;
    }
    
    .tab-btn.active {
        background: linear-gradient(to right, #58cc02, #1cb0f6);
        color: white;
    }
    
    .tab-btn:hover:not(.active) {
        background: #d0d0d0;
    }
    
    .numbers-grid-100 {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: 10px;
        margin-top: 20px;
    }
    
    .number-card-100 {
        background: white;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        text-align: center;
        cursor: pointer;
        transition: 0.3s;
    }
    
    .number-card-100:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .number-card-100 .main-char {
        font-size: 1.5rem;
        margin-bottom: 5px;
    }
    
    .number-card-100 .small-char {
        font-size: 0.9rem;
        color: #1cb0f6;
    }
    
    .pagination {
        display: flex;
        justify-content: center;
        margin: 20px 0;
        gap: 10px;
        flex-wrap: wrap;
    }
    
    .pagination-btn {
        background: #e0e0e0;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 0.9rem;
    }
    
    .pagination-btn.active {
        background: #58cc02;
        color: white;
    }
    
    .pagination-btn:hover:not(.active) {
        background: #d0d0d0;
    }
    
    #globalBack, .back-btn-lesson {
        position: fixed;
        top: 15px;
        left: 15px;
        z-index: 1000;
        margin: 0;
        background: linear-gradient(to right, #58cc02, #1cb0f6);
        border: none;
        color: white;
        padding: 8px 15px;
        border-radius: 50px;
        font-family: 'Baloo 2', cursive;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    
    #globalBack:hover, .back-btn-lesson:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    #globalBack:active, .back-btn-lesson:active {
        transform: scale(0.95);
    }
    
    .progress-indicator {
        position: absolute;
        top: 10px;
        right: 15px;
        background: #58cc02;
        color: white;
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.8rem;
        font-family: 'Baloo 2', cursive;
    }
    
    @media (max-width: 600px) {
        .main-char { font-size: 1.5rem; } 
        .small-char { font-size: 1rem; } 
        .example { font-size: 0.9rem; }
        
        .sub-container {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .sub-card {
            padding: 15px;
        }
        
        .sub-card h3 { 
            font-size: 1rem; 
        }
        
        .sub-card p { 
            font-size: 0.8rem; 
        }
        
        #globalBack, .back-btn-lesson {
            top: 10px;
            left: 10px;
            padding: 6px 12px;
            font-size: 0.9rem;
        }
        
        #app {
            padding-top: 45px;
        }
        
        .lesson-container .main-char {
            font-size: 2.5rem;
        }
        
        .lesson-container .example {
            font-size: 1.1rem;
        }
        
        .progress-indicator {
            top: 5px;
            right: 10px;
            font-size: 0.7rem;
            padding: 3px 8px;
        }
    }
</style>
</head>
<body>

<button id="globalBack" onclick="goBackHome()">
   Back
</button>
<div id="app">
  <div class="progress-indicator" id="progressIndicator">Progress: 0%</div>
  <div id="learning-content"></div>
</div>

<script>
// ===== PAGE-SPECIFIC DATA AND FUNCTIONS =====

const VOWELS = [
    {marathi:"‡§Ö", english:"a", word:"‡§Ö‡§®‡§®‡§∏ (Pineapple üçç)", pronunciation:"a"}, {marathi:"‡§Ü", english:"aa", word:"‡§Ü‡§à (Mother üë©‚Äçüë¶)", pronunciation:"aa"}, {marathi:"‡§á", english:"i", word:"‡§á‡§Æ‡§æ‡§∞‡§§ (Building üè¢)", pronunciation:"i"}, {marathi:"‡§à", english:"ee", word:"‡§à‡§°‡§≤‡•Ä‡§Ç‡§¨‡•Ç (Lemon üçã)", pronunciation:"ee"}, {marathi:"‡§â", english:"u", word:"‡§â‡§Ç‡§¶‡•Ä‡§∞ (Mouse üê≠)", pronunciation:"u"}, {marathi:"‡§ä", english:"oo", word:"‡§ä‡§∏ (Sugarcane üéã)", pronunciation:"oo"}, {marathi:"‡•†", english:"rri", word:"‡•†‡§∑‡•Ä (Sage üßô‚Äç‚ôÇÔ∏è)", pronunciation:"rru"}, {marathi:"‡§è", english:"e", word:"‡§è‡§°‡§ï‡§æ (Ram üêè)", pronunciation:"e"}, {marathi:"‡§ê", english:"ai", word:"‡§ê‡§∞‡§æ‡§µ‡§§ (Elephant üêò)", pronunciation:"ai"}, {marathi:"‡§ì", english:"o", word:"‡§ì‡§† (Lips üëÑ)", pronunciation:"o"}, {marathi:"‡§î", english:"au", word:"‡§î‡§∑‡§ß (Medicine üíä)", pronunciation:"au"}, {marathi:"‡§Ö‡§Ç", english:"an", word:"‡§Ö‡§Ç‡§ó‡§†‡•Ä (Ring üíç)", pronunciation:"an"}, {marathi:"‡§Ö‡§É", english:"ah", word:"Ah! (Exclamation)", pronunciation:"ah"}
];

const CONSONANTS = [
    {marathi:"‡§ï", english:"ka", word:"‡§ï‡§Æ‡§≥ (Lotus üå∏)", pronunciation:"ka"}, {marathi:"‡§ñ", english:"kha", word:"‡§ñ‡§∞‡§¨‡•Ç‡§ú (Melon üçà)", pronunciation:"kha"}, {marathi:"‡§ó", english:"ga", word:"‡§ó‡§µ‡§§ (Grass üåæ)", pronunciation:"ga"}, {marathi:"‡§ò", english:"gha", word:"‡§ò‡§∞ (House üè†)", pronunciation:"gha"}, {marathi:"‡§ô", english:"nga", word:"‡§ô (Velar nasal)", pronunciation:"nga"}, {marathi:"‡§ö", english:"cha", word:"‡§ö‡§Æ‡§ö‡§æ (Spoon ü•Ñ)", pronunciation:"cha"}, {marathi:"‡§õ", english:"chha", word:"‡§õ‡§§‡•ç‡§∞‡•Ä (Umbrella ‚òÇÔ∏è)", pronunciation:"chha"}, {marathi:"‡§ú", english:"ja", word:"‡§ú‡§π‡§æ‡§ú (Ship üö¢)", pronunciation:"ja"}, {marathi:"‡§ù", english:"jha", word:"‡§ù‡§ó‡§æ (Dress üëó)", pronunciation:"jha"}, {marathi:"‡§û", english:"nya", word:"‡§û (Palatal nasal)", pronunciation:"nya"}, {marathi:"‡§ü", english:"ta", word:"‡§ü‡§∞‡§¨‡•Ç‡§ú (Watermelon üçâ)", pronunciation:"ta"}, {marathi:"‡§†", english:"tha", word:"‡§†‡§∏‡§æ (Stamp ‚úâÔ∏è)", pronunciation:"tha"}, {marathi:"‡§°", english:"da", word:"‡§°‡§¨‡•ç‡§¨‡§æ (Tiffin üç±)", pronunciation:"da"}, {marathi:"‡§¢", english:"dha", word:"‡§¢‡§ó (Cloud ‚òÅÔ∏è)", pronunciation:"dha"}, {marathi:"‡§£", english:"na", word:"‡§£ (Retroflex nasal)", pronunciation:"na"}, {marathi:"‡§§", english:"ta", word:"‡§§‡§≤‡§µ‡§æ‡§∞ (Sword ‚öîÔ∏è)", pronunciation:"ta"}, {marathi:"‡§•", english:"tha", word:"‡§•‡§µ‡§æ (Flock üêë)", pronunciation:"tha"}, {marathi:"‡§¶", english:"da", word:"‡§¶‡§∞‡§µ‡§æ‡§ú‡§æ (Door üö™)", pronunciation:"da"}, {marathi:"‡§ß", english:"dha", word:"‡§ß‡§®‡•Å‡§∑‡•ç‡§Ø (Bow üèπ)", pronunciation:"dha"}, {marathi:"‡§®", english:"na", word:"‡§®‡§≥ (Tap üö∞)", pronunciation:"na"}, {marathi:"‡§™", english:"pa", word:"‡§™‡§§‡§Ç‡§ó (Kite ü™Å)", pronunciation:"pa"}, {marathi:"‡§´", english:"pha", word:"‡§´‡§£‡§∏ (Jackfruit üçà)", pronunciation:"pha"}, {marathi:"‡§¨", english:"ba", word:"‡§¨‡§¶‡§ï (Duck ü¶Ü)", pronunciation:"ba"}, {marathi:"‡§≠", english:"bha", word:"‡§≠‡§ü‡§ú‡•Ä (Priest üôè)", pronunciation:"bha"}, {marathi:"‡§Æ", english:"ma", word:"‡§Æ‡§ó‡§∞ (Crocodile üêä)", pronunciation:"ma"}, {marathi:"‡§Ø", english:"ya", word:"‡§Ø‡§ú‡•ç‡§û (Sacred ritual üî•)", pronunciation:"ya"}, {marathi:"‡§∞", english:"ra", word:"‡§∞‡§∏‡•ç‡§§‡§æ (Road üõ£Ô∏è)", pronunciation:"ra"}, {marathi:"‡§≤", english:"la", word:"‡§≤‡§∏‡•Ç‡§£ (Garlic üßÑ)", pronunciation:"la"}, {marathi:"‡§µ", english:"va", word:"‡§µ‡§ú‡§® (Weight ‚öñÔ∏è)", pronunciation:"va"}, {marathi:"‡§∂", english:"sha", word:"‡§∂‡§π‡§æ‡§Æ‡•É‡§ó (Ostrich ü¶©)", pronunciation:"sha"}, {marathi:"‡§∑", english:"sha", word:"‡§∑‡§ü‡•ç‡§ï‡•ã‡§£ (Hexagon ‚¨¢)", pronunciation:"sha"}, {marathi:"‡§∏", english:"sa", word:"‡§∏‡§∏‡§æ (Rabbit üêá)", pronunciation:"sa"}, {marathi:"‡§π", english:"ha", word:"‡§π‡§∞‡§ø‡§£ (Deer ü¶å)", pronunciation:"ha"}, {marathi:"‡§≥", english:"la", word:"‡§≥ (Retroflex lateral)", pronunciation:"la"}, {marathi:"‡§ï‡•ç‡§∑", english:"ksha", word:"‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ø‡§Ø (Warrior ‚öîÔ∏è)", pronunciation:"ksha"}, {marathi:"‡§ú‡•ç‡§û", english:"gya", word:"‡§ú‡•ç‡§û‡§æ‡§® (Knowledge üìö)", pronunciation:"gya"}
];

const NUMBERS = [
    {marathi:"‡•ß", english:"1", word:"‡§è‡§ï (One)", pronunciation:"ek"}, {marathi:"‡•®", english:"2", word:"‡§¶‡•ã‡§® (Two)", pronunciation:"don"}, {marathi:"‡•©", english:"3", word:"‡§§‡•Ä‡§® (Three)", pronunciation:"teen"}, {marathi:"‡•™", english:"4", word:"‡§ö‡§æ‡§∞ (Four)", pronunciation:"chaar"}, {marathi:"‡•´", english:"5", word:"‡§™‡§æ‡§ö (Five)", pronunciation:"paach"}, {marathi:"‡•¨", english:"6", word:"‡§∏‡§π‡§æ (Six)", pronunciation:"sahaa"}, {marathi:"‡•≠", english:"7", word:"‡§∏‡§æ‡§§ (Seven)", pronunciation:"saat"}, {marathi:"‡•Æ", english:"8", word:"‡§Ü‡§† (Eight)", pronunciation:"aath"}, {marathi:"‡•Ø", english:"9", word:"‡§®‡§ä (Nine)", pronunciation:"nau"}, {marathi:"‡•ß‡•¶", english:"10", word:"‡§¶‡§π‡§æ (Ten)", pronunciation:"dahaa"}
];

const MARATHI_NUMERALS = ["‡•¶", "‡•ß", "‡•®", "‡•©", "‡•™", "‡•´", "‡•¨", "‡•≠", "‡•Æ", "‡•Ø"];

function generateMarathiNumber(num) {
  if (num === 100) return "‡•ß‡•¶‡•¶";
  let result = "";
  if (num >= 10) {
    result += MARATHI_NUMERALS[Math.floor(num / 10)];
  }
  result += MARATHI_NUMERALS[num % 10];
  return result;
}

const NUMBERS_1_TO_100 = Array.from({length: 100}, (_, i) => ({
  marathi: generateMarathiNumber(i + 1),
  english: (i + 1).toString()
}));

function speakText(text, lang = 'mr-IN') {
  if ('speechSynthesis' in window) {
    window.speechSynthesis.cancel();
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = lang;
    utterance.rate = 0.8;
    window.speechSynthesis.speak(utterance);
  }
}

// CORRECTED tracking functions that call the global functions from mrprogress.js
function trackAlphabetProgress(type, index) {
    const itemId = `${type}_${index}`; // Creates a unique ID like "vowels_0" or "consonants_5"
    if (typeof updateMarathiProgress === 'function') {
        updateMarathiProgress('level1', 'alphabets', itemId);
    }
}

function trackNumberProgress(index) {
    if (typeof updateMarathiProgress === 'function') {
        updateMarathiProgress('level1', 'numbers', index);
    }
}


function updateProgressIndicator() {
  // This function requires the progress object. Ensure it's initialized first.
  if (typeof initMarathiProgress !== 'function') return;
  const progress = JSON.parse(localStorage.getItem('linguaKidsMarathiProgress'));
  if (!progress) return;

  let totalCompleted = 0;
  let totalPossible = 0;
  
  Object.values(progress).forEach(level => {
    if (level && typeof level === 'object') {
      Object.values(level).forEach(category => {
        if (category && typeof category.completed !== 'undefined') {
          totalCompleted += category.completed;
          totalPossible += category.total;
        }
      });
    }
  });
  
  const overallProgress = totalPossible > 0 ? Math.round((totalCompleted / totalPossible) * 100) : 0;
  
  const indicator = document.getElementById('progressIndicator');
  if (indicator) {
    indicator.textContent = `Progress: ${overallProgress}%`;
  }
}

function loadLevel1() {
  toggleGlobalBack(true);
  document.getElementById("learning-content").innerHTML = `
    <h2>Progress Tracking</h2>
    <div class="sub-container">
      <div class="sub-card" onclick="window.location.href='mrprogress.html'">
        <h3>My Progress</h3><p>Track your learning journey</p>
      </div>
    </div>
    <h2>Level 1: ‡§Ö‡§ï‡•ç‡§∑‡§∞‡•á ‡§Ü‡§£‡§ø ‡§Ö‡§Ç‡§ï</h2>
    <div class="sub-container">
      <div class="sub-card" onclick="loadAlphabetsMenu()">
        <h3>‡§µ‡§∞‡•ç‡§£‡§Æ‡§æ‡§≤‡§æ (Alphabets)</h3><p>Learn A‚ÄìZ with tracing & sounds</p>
      </div>
      <div class="sub-card" onclick="loadNumbersMenu()">
        <h3>‡§Ö‡§Ç‡§ï (Numbers)</h3><p>Learn 1‚Äì100 with objects & tracing</p>
      </div>
    </div>
    <h2>Level 2: Basic Words</h2>
    <div class="sub-container">
      <div class="sub-card" onclick="goToLevel2('fruits')"><h3>‡§´‡§≥‡•á</h3><p>Fruits</p></div>
      <div class="sub-card" onclick="goToLevel2('vegetables')"><h3>‡§≠‡§æ‡§ú‡•ç‡§Ø‡§æ</h3><p>Vegetables</p></div>
      <div class="sub-card" onclick="goToLevel2('animals')"><h3>‡§™‡•ç‡§∞‡§æ‡§£‡•Ä</h3><p>Animals</p></div>
      <div class="sub-card" onclick="goToLevel2('birds')"><h3>‡§™‡§ï‡•ç‡§∑‡•Ä</h3><p>Birds</p></div>
      <div class="sub-card" onclick="goToLevel2('vehicles')"><h3>‡§µ‡§æ‡§π‡§®‡•á</h3><p>Vehicles</p></div>
      <div class="sub-card" onclick="goToLevel2('colors')"><h3>‡§∞‡§Ç‡§ó</h3><p>Colors</p></div>
    </div>
    <h2>Level 3: Sentences</h2>
    <div class="sub-container">
      <div class="sub-card" onclick="goToLevel3('greetings')"><h3>‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞</h3><p>Greetings</p></div>
      <div class="sub-card" onclick="goToLevel3('activities')"><h3>‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ</h3><p>Activities</p></div>
      <div class="sub-card" onclick="goToLevel3('questions')"><h3>‡§™‡•ç‡§∞‡§∂‡•ç‡§®</h3><p>Questions</p></div>
    </div>
    <h2>Games</h2>
    <div class="sub-container">
      <div class="sub-card" onclick="playGame('fill-blanks')"><h3>Fill in the blanks</h3></div>
      <div class="sub-card" onclick="playGame('match-words')"><h3>Match words</h3></div>
      <div class="sub-card" onclick="playGame('count-apples')"><h3>Count the apples</h3></div>
    </div>
  `;
}

function loadAlphabetsMenu() {
  toggleGlobalBack(false);
  document.getElementById("learning-content").innerHTML = `
    <button class="btn back-btn-lesson" onclick="loadLevel1()">Back</button>
    <div class="tab-container">
      <button class="tab-btn active" onclick="showTab('vowels', this)">‡§∏‡•ç‡§µ‡§∞ (Vowels)</button>
      <button class="tab-btn" onclick="showTab('consonants', this)">‡§µ‡•ç‡§Ø‡§Ç‡§ú‡§® (Consonants)</button>
    </div>
    <div id="vowels-tab" class="letters-grid">
      ${VOWELS.map((l, index) => `
        <div class="letter-card" onclick="startAlphabetLesson(${index}, 'vowels')">
          <div class="main-char">${l.marathi}</div>
          <div class="small-char">${l.english}</div>
          <div class="example">${l.word}</div>
          <button class="sound-btn" onclick="event.stopPropagation(); speakText('${l.pronunciation}'); trackAlphabetProgress('vowels', ${index});">
            <i class="fas fa-volume-up"></i>
          </button>
        </div>`).join("")}
    </div>
    <div id="consonants-tab" class="letters-grid" style="display:none;">
      ${CONSONANTS.map((l, index) => `
        <div class="letter-card" onclick="startAlphabetLesson(${index}, 'consonants')">
          <div class="main-char">${l.marathi}</div>
          <div class="small-char">${l.english}</div>
          <div class="example">${l.word}</div>
          <button class="sound-btn" onclick="event.stopPropagation(); speakText('${l.pronunciation}'); trackAlphabetProgress('consonants', ${index});">
            <i class="fas fa-volume-up"></i>
          </button>
        </div>`).join("")}
    </div>
  `;
}

function showTab(tabName, element) {
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  element.classList.add('active');
  document.getElementById('vowels-tab').style.display = tabName === 'vowels' ? 'grid' : 'none';
  document.getElementById('consonants-tab').style.display = tabName === 'consonants' ? 'grid' : 'none';
}

function startAlphabetLesson(index, type = 'vowels') {
  toggleGlobalBack(false);
  const letters = type === 'vowels' ? VOWELS : CONSONANTS;
  if (index < 0 || index >= letters.length) { loadAlphabetsMenu(); return; }
  
  const l = letters[index];
  trackAlphabetProgress(type, index); // Track progress when a lesson is started

  document.getElementById("learning-content").innerHTML = `
    <button class="btn back-btn-lesson" onclick="loadAlphabetsMenu()">Back</button>
    <div class="lesson-container">
      <div class="main-char">${l.marathi}</div>
      <div class="example">${l.word}</div>
      <button class="sound-btn" onclick="speakText('${l.pronunciation}')" style="margin:10px;"><i class="fas fa-volume-up"></i></button>
      <div class="trace-area"><canvas id="traceCanvas" width="250" height="250"></canvas><button class="btn clear-btn" onclick="clearCanvas()">Clear</button></div>
      <div class="lesson-controls">
        <button class="btn" onclick="startAlphabetLesson(${index - 1}, '${type}')">Previous</button>
        <button class="btn" onclick="startAlphabetLesson(${index + 1}, '${type}')">Next</button>
      </div>
    </div>`;
  initCanvas();
}

function loadNumbersMenu() {
  toggleGlobalBack(false);
  document.getElementById("learning-content").innerHTML = `
    <button class="btn back-btn-lesson" onclick="loadLevel1()">Back</button>
    <div class="numbers-grid-100" id="numbers-grid-100"></div>
    <div class="pagination" id="numbers-pagination"></div>
  `;
  showNumbersPage(0);
}

function showNumbersPage(page) {
  const itemsPerPage = 20;
  const startIndex = page * itemsPerPage;
  const endIndex = Math.min(startIndex + itemsPerPage, NUMBERS_1_TO_100.length);
  const totalPages = Math.ceil(NUMBERS_1_TO_100.length / itemsPerPage);
  
  let paginationHtml = '';
  for (let i = 0; i < totalPages; i++) {
    paginationHtml += `<button class="pagination-btn ${i === page ? 'active' : ''}" onclick="showNumbersPage(${i})">${i * itemsPerPage + 1}-${Math.min((i + 1) * itemsPerPage, 100)}</button>`;
  }
  document.getElementById('numbers-pagination').innerHTML = paginationHtml;
  
  let numbersHtml = '';
  for (let i = startIndex; i < endIndex; i++) {
    const n = NUMBERS_1_TO_100[i];
    numbersHtml += `
      <div class="number-card-100" onclick="trackNumberProgress(${i})">
        <div class="main-char">${n.marathi}</div>
        <div class="small-char">${n.english}</div>
        <button class="sound-btn" onclick="event.stopPropagation(); speakText('${n.english}'); trackNumberProgress(${i});">
          <i class="fas fa-volume-up"></i>
        </button>
      </div>`;
  }
  document.getElementById('numbers-grid-100').innerHTML = numbersHtml;
}

function initCanvas() {
    const canvas = document.getElementById("traceCanvas");
    const ctx = canvas.getContext("2d");
    ctx.lineWidth = 4; ctx.lineCap = "round"; ctx.strokeStyle = "#58cc02";
    let drawing = false;

    function getPos(e) {
        const rect = canvas.getBoundingClientRect();
        const touch = e.touches ? e.touches[0] : e;
        return { x: touch.clientX - rect.left, y: touch.clientY - rect.top };
    }

    function startDrawing(e) { drawing = true; }
    function stopDrawing() { drawing = false; ctx.beginPath(); }
    function draw(e) {
        if (!drawing) return;
        e.preventDefault();
        const p = getPos(e);
        ctx.lineTo(p.x, p.y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(p.x, p.y);
    }
    
    canvas.addEventListener("mousedown", startDrawing);
    canvas.addEventListener("mouseup", stopDrawing);
    canvas.addEventListener("mousemove", draw);
    canvas.addEventListener("touchstart", startDrawing);
    canvas.addEventListener("touchend", stopDrawing);
    canvas.addEventListener("touchmove", draw);
}

function clearCanvas() {
  const canvas = document.getElementById("traceCanvas");
  if (canvas) {
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
}

function toggleGlobalBack(show) {
  document.getElementById("globalBack").style.display = show ? "inline-block" : "none";
}

function goBackHome() {
  window.location.href = "welcome.html";
}

function goToLevel2(category) {
  window.location.href = "mrlevel2.html?category=" + category;
}

function goToLevel3(category) {
  window.location.href = "mrlevel3.html?category=" + category;
}

function playGame(gameType) {
  window.location.href = "mrgames.html?game=" + gameType;
}

// ===== INITIALIZATION =====
document.addEventListener('DOMContentLoaded', function() {
  if (typeof initMarathiProgress === 'function') {
    initMarathiProgress(); // Initialize or load progress data
    updateProgressIndicator(); // Update the UI with the latest progress
  }
  loadLevel1(); // Load the main menu
});

</script>

<script src="mrprogress.js"></script>
<script src="script.js"></script>

</body>
</html>